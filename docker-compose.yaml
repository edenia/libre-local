version: "3.6"
services:
  genesis:
    container_name: genesis
    build: ./nodes/genesis
    image: ${DOCKER_REGISTRY}/${IMAGE_NAME}
    ports:
      - "8888:8888"
      - "9876:9876"
      - "9879:9879"
    volumes:
      - ./wasm/system-contracts:/eosio.contracts
      - ./wasm/staking-contract:/staking-contract
      - ./wasm/libre-referrals:/referral
      - ./wasm/dao-contract:/btclgovernan
      - ./wasm/swap-contract:/swap
    working_dir: /app
    command: bash -c "./start.sh"
    environment:
      TESTNET_EOSIO_PRIVATE_KEY: "${TESTNET_EOSIO_PRIVATE_KEY}"
      TESTNET_EOSIO_PUBLIC_KEY: "${TESTNET_EOSIO_PUBLIC_KEY}"
  bp2:
    container_name: bp2
    build: ./nodes/bp2
    image: ${DOCKER_REGISTRY}/${IMAGE_NAME}2
    ports:
      - "8890:8888"
      - "9880:9876"
      - "9881:9879"
    working_dir: /opt/scripts
    command: bash -c "./start.sh"
    environment:
      TESTNET_NODE_PRIVATE_KEY: "${TESTNET_NODE_PRIVATE_KEY}"
      TESTNET_NODE_PUBLIC_KEY: "${TESTNET_NODE_PUBLIC_KEY}"
  bp3:
    container_name: bp3
    build: ./nodes/bp3
    image: ${DOCKER_REGISTRY}/${IMAGE_NAME}3
    ports:
      - "8891:8888"
      - "9882:9876"
      - "9883:9879"
    working_dir: /opt/scripts
    command: bash -c "./start.sh"
    environment:
      TESTNET_NODE2_PRIVATE_KEY: "${TESTNET_NODE2_PRIVATE_KEY}"
      TESTNET_NODE2_PUBLIC_KEY: "${TESTNET_NODE2_PUBLIC_KEY}"
  bp4:
    container_name: bp4
    build: ./nodes/bp4
    image: ${DOCKER_REGISTRY}/${IMAGE_NAME}4
    ports:
      - "8892:8888"
      - "9884:9876"
      - "9885:9879"
    working_dir: /opt/scripts
    command: bash -c "./start.sh"
    environment:
      TESTNET_NODE3_PRIVATE_KEY: "${TESTNET_NODE3_PRIVATE_KEY}"
      TESTNET_NODE3_PUBLIC_KEY: "${TESTNET_NODE3_PUBLIC_KEY}"
  bp5:
    container_name: bp5
    build: ./nodes/bp5
    image: ${DOCKER_REGISTRY}/${IMAGE_NAME}5
    ports:
      - "8893:8888"
      - "9886:9876"
      - "9887:9879"
    working_dir: /opt/scripts
    command: bash -c "./start.sh"
    environment:
      TESTNET_NODE4_PRIVATE_KEY: "${TESTNET_NODE4_PRIVATE_KEY}"
      TESTNET_NODE4_PUBLIC_KEY: "${TESTNET_NODE4_PUBLIC_KEY}"
